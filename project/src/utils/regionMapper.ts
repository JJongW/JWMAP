import type { Province } from '../types/location';

const provincePatterns: { pattern: string; province: Province }[] = [
  { pattern: '서울', province: '서울' },
  { pattern: '경기', province: '경기' },
  { pattern: '인천', province: '인천' },
  { pattern: '부산', province: '부산' },
  { pattern: '대구', province: '대구' },
  { pattern: '대전', province: '대전' },
  { pattern: '광주광역시', province: '광주' },
  { pattern: '울산', province: '울산' },
  { pattern: '세종', province: '세종' },
  { pattern: '강원', province: '강원' },
  { pattern: '충청북도', province: '충북' },
  { pattern: '충북', province: '충북' },
  { pattern: '충청남도', province: '충남' },
  { pattern: '충남', province: '충남' },
  { pattern: '전라북도', province: '전북' },
  { pattern: '전북', province: '전북' },
  { pattern: '전라남도', province: '전남' },
  { pattern: '전남', province: '전남' },
  { pattern: '경상북도', province: '경북' },
  { pattern: '경북', province: '경북' },
  { pattern: '경상남도', province: '경남' },
  { pattern: '경남', province: '경남' },
  { pattern: '제주', province: '제주' },
];

const districtMaps: Record<Province, Record<string, string>> = {
  서울: {
    강남구: '강남', 서초구: '서초', 송파구: '잠실/송파/강동', 강동구: '잠실/송파/강동',
    영등포구: '영등포/여의도/강서', 강서구: '영등포/여의도/강서',
    광진구: '건대/성수/왕십리', 성동구: '건대/성수/왕십리', 종로구: '종로/중구',
    중구: '종로/중구', 마포구: '홍대/합정/마포/연남', 용산구: '용산/이태원/한남',
    성북구: '성북/노원/중랑', 노원구: '성북/노원/중랑', 중랑구: '성북/노원/중랑',
    구로구: '구로/관악/동작', 관악구: '구로/관악/동작', 동작구: '구로/관악/동작',
    서대문구: '신촌/연희', 도봉구: '창동/도봉산', 동대문구: '회기/청량리',
    은평구: '연신내/구파발', 강북구: '미아/수유/북한산', 양천구: '목동/양천', 금천구: '금천/가산',
  },
  경기: {
    수원시: '수원', 성남시: '성남/분당', 분당: '성남/분당', 고양시: '고양/일산', 일산: '고양/일산',
    용인시: '용인', 부천시: '부천', 안양시: '안양/과천', 과천시: '안양/과천', 안산시: '안산',
    화성시: '화성/동탄', 동탄: '화성/동탄', 평택시: '평택', 의정부시: '의정부', 파주시: '파주',
    김포시: '김포', 광명시: '광명', 광주시: '광주', 하남시: '하남', 시흥시: '시흥',
    군포시: '군포/의왕', 의왕시: '군포/의왕', 오산시: '오산', 이천시: '이천', 안성시: '안성',
    양평군: '양평/여주', 여주시: '양평/여주', 구리시: '구리/남양주', 남양주시: '구리/남양주',
    포천시: '포천/동두천', 동두천시: '포천/동두천', 양주시: '양주', 가평군: '가평', 연천군: '연천',
  },
  인천: {
    부평구: '부평', 연수구: '송도/연수', 송도: '송도/연수', 계양구: '계양',
    남동구: '남동구', 서구: '서구/검단', 검단: '서구/검단', 중구: '중구/동구',
    동구: '중구/동구', 강화군: '강화/옹진', 옹진군: '강화/옹진',
  },
  부산: {
    부산진구: '서면', 서면: '서면', 해운대구: '해운대', 해운대: '해운대',
    수영구: '광안리/수영', 광안리: '광안리/수영', 센텀: '센텀시티', 중구: '남포동/중앙동',
    남포동: '남포동/중앙동', 동래구: '동래/온천장', 온천장: '동래/온천장',
    사상구: '사상/덕천', 덕천: '사상/덕천', 북구: '사상/덕천', 기장군: '기장',
    사하구: '사하/다대포', 다대포: '사하/다대포', 연제구: '연산/토곡', 연산동: '연산/토곡',
  },
  대구: {
    중구: '동성로/중구', 동성로: '동성로/중구', 수성구: '수성구', 범어동: '범어/만촌',
    만촌동: '범어/만촌', 동구: '동대구/신천', 동대구: '동대구/신천', 신천동: '동대구/신천',
    북구: '북구/칠곡', 칠곡: '북구/칠곡', 달서구: '달서구', 경북대: '경대/대현', 대현동: '경대/대현',
  },
  대전: {
    서구: '둔산', 둔산동: '둔산', 유성구: '유성/궁동', 궁동: '유성/궁동',
    중구: '대전역/중앙로', 대전역: '대전역/중앙로', 관저동: '서구/관저', 동구: '동구/대동', 대동: '동구/대동',
  },
  광주: {
    동구: '충장로/동구', 충장로: '충장로/동구', 서구: '상무지구', 상무: '상무지구',
    광산구: '첨단지구', 첨단: '첨단지구', 수완: '수완지구', 송정역: '광주송정역', 송정동: '광주송정역',
  },
  울산: {
    남구: '삼산/신정', 삼산동: '삼산/신정', 신정동: '삼산/신정', 중구: '성남동/중구',
    성남동: '성남동/중구', 동구: '동구/방어진', 방어진: '동구/방어진', 울주군: '울주/언양', 언양: '울주/언양',
  },
  세종: { 조치원: '조치원', 어진동: '정부청사/어진동', 정부청사: '정부청사/어진동', 나성동: '나성동/다정동', 다정동: '나성동/다정동' },
  강원: { 춘천시: '춘천', 원주시: '원주', 강릉시: '강릉', 속초시: '속초/양양', 양양군: '속초/양양', 동해시: '동해/삼척', 삼척시: '동해/삼척', 평창군: '평창/정선', 정선군: '평창/정선', 홍천군: '홍천/횡성', 횡성군: '홍천/횡성' },
  충북: { 청주시: '청주', 충주시: '충주', 제천시: '제천', 음성군: '음성/진천', 진천군: '음성/진천' },
  충남: { 천안시: '천안', 아산시: '아산', 서산시: '서산/당진', 당진시: '서산/당진', 공주시: '공주/부여', 부여군: '공주/부여', 논산시: '논산/계룡', 계룡시: '논산/계룡', 홍성군: '홍성/예산', 예산군: '홍성/예산' },
  전북: { 전주시: '전주', 익산시: '익산', 군산시: '군산', 정읍시: '정읍/김제', 김제시: '정읍/김제', 남원시: '남원/순창', 순창군: '남원/순창' },
  전남: { 여수시: '여수', 순천시: '순천', 광양시: '광양', 목포시: '목포', 나주시: '나주', 무안군: '무안/영암', 영암군: '무안/영암' },
  경북: { 포항시: '포항', 경주시: '경주', 구미시: '구미', 안동시: '안동', 김천시: '김천', 영주시: '영주/봉화', 봉화군: '영주/봉화', 상주시: '상주/문경', 문경시: '상주/문경' },
  경남: { 창원시: '창원/마산', 마산: '창원/마산', 김해시: '김해', 진주시: '진주', 양산시: '양산', 거제시: '거제', 통영시: '통영/고성', 고성군: '통영/고성', 밀양시: '밀양/창녕', 창녕군: '밀양/창녕' },
  제주: { 제주시: '제주시', 서귀포시: '서귀포', 애월읍: '애월/한림', 한림읍: '애월/한림', 성산읍: '성산/표선', 표선면: '성산/표선', 중문: '중문' },
};

export function extractRegionFromAddress(address: string): { province: Province; region: string } | null {
  let detectedProvince: Province | null = null;
  for (const { pattern, province } of provincePatterns) {
    if (address.includes(pattern)) {
      detectedProvince = province;
      break;
    }
  }
  if (!detectedProvince) return null;

  const districtMap = districtMaps[detectedProvince];
  let detectedRegion = '';
  for (const [key, value] of Object.entries(districtMap || {})) {
    if (address.includes(key)) {
      detectedRegion = value;
      break;
    }
  }

  return { province: detectedProvince, region: detectedRegion };
}
